<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mybatis.mapper.VisiterMapper">

	<insert id="insert" parameterType="String">
		insert into visiter values(#{ip_address},sysdate)
	</insert>
	
	<select id="onedayselect" parameterType="String" resultType="com.spring.ott.vo.VisiterVo">
		select ip_address, count(ip_address) count, to_char(visit_date,'YYYY/MM/DD') visit_date2 from visiter
		group by to_char(visit_date,'YYYY/MM/DD'),ip_address
		having to_char(visit_date,'YYYY/MM/DD')=#{visit_date}
		order by count desc
	</select>
	<select id="alldayselect" resultType="com.spring.ott.vo.VisiterVo">
		select ip_address, count(ip_address) count, to_char(visit_date,'YYYY/MM/DD') visit_date2 from visiter
		group by to_char(visit_date,'YYYY/MM/DD'),ip_address
		order by visit_date2 desc
	</select>
	
	<select id="rankingselect" parameterType="String" resultType="com.spring.ott.vo.VisiterVo">
		
		SELECT * FROM
		( SELECT ip_address, count(ip_address) count, to_char(visit_date,'YYYY/MM/DD') visit_date2 
		from visiter
		group by to_char(visit_date,'YYYY/MM/DD'),ip_address
		having to_char(visit_date,'YYYY/MM/DD')=#{visit_date}
		) 
		WHERE ROWNUM &lt; 6
		order by count desc
		
	</select>
	
	<select id="onedaylog" parameterType="String" resultType="int">
		select count(ip_address) count 
		from visiter 
		where to_char(visit_date,'YYYY/MM/DD')=#{visit_date}
	</select>
	
	
	<!-- 멤버 차트 -->
	<select id="membercount6" resultType="com.spring.ott.vo.VisiterVo">
		SELECT COUNT(black_enabled) COUNT FROM USERS 
		WHERE black_enabled = 0 AND enabeld = '1'
	</select>
	<select id="membercount7" resultType="com.spring.ott.vo.VisiterVo">
		SELECT COUNT(black_enabled) COUNT FROM USERS 
		WHERE black_enabled = 0 AND enabeld = '1'
	</select>
	
	<select id="membercount1" resultType="com.spring.ott.vo.VisiterVo">
		SELECT COUNT(age) COUNT FROM USERS 
		WHERE AGE &gt; 9 AND AGE &lt; 20
	</select>
	<select id="membercount2" resultType="com.spring.ott.vo.VisiterVo">
		SELECT COUNT(age) COUNT FROM USERS 
		WHERE AGE &gt; 19 AND AGE &lt; 30
	</select>
	<select id="membercount3" resultType="com.spring.ott.vo.VisiterVo">
		SELECT COUNT(age) COUNT FROM USERS 
		WHERE AGE &gt; 29 AND AGE &lt; 40
	</select>
	<select id="membercount4" resultType="com.spring.ott.vo.VisiterVo">
		SELECT COUNT(age) COUNT FROM USERS 
		WHERE AGE &gt; 39 AND AGE &lt; 50
	</select>
	<select id="membercount5" parameterType="String" resultType="com.spring.ott.vo.VisiterVo">
		SELECT COUNT(regdate) COUNT FROM USERS
		group by to_char(regdate,'YYYY/MM/DD')
	HAVING to_char(regdate,'YYYY/MM/DD')=#{visit_date} AND to_char(regdate,'YYYY/MM/DD')=#{visit_date1}
	</select>
	
	
</mapper>